<h1><%= @auction.title %></h1>
<p><%= @auction.details %></p>
<p>End Date: <%= @auction.end_on %></p>
<% if @auction.bids.size > 0 %>
    <% max = @auction.bids.maximum("amount") %>
<% else %>
    <% max = 0 %>
    <% end %>

<% if max >= @auction.reserve_price %>
        <p>Got It!</p>
        <p>Deal Price:<%= " $#{max}" %>
        <% @auction.reserve %>
<% else %>
        <p>Reserve Price Not Met </p>
        <p>Current Price:<%= " $#{max + 1}" %>
        <hr>
        <% if (user_signed_in? && @auction.user_id != current_user.id) %>
            <h2>Make a bid</h2>
            <%= simple_form_for [@auction, @bid] do |f| %>
              <%= f.input :amount, as: :string %>
              <%= f.submit "bid", class: "btn btn-primary" %>
            <% end %>
            <div class="clearfix"></div>
        <% end %>
<% end %>


<p><%= @auction.aasm_state.capitalize %></p>
<%# may_publish? is a method generated by AASM that will tell you if you're able
    to publish a auction based on the rules defined in the Auction AASM %>

<hr>
<h2>Previous Bids</h2>
<% @auction.bids.each do |bid| %>
<div class="row">
  <div class="col-md-3 well">
      <%= number_to_currency(bid.amount) %><%= bid.created_at %>
  </div>
<% end %>
</div>
